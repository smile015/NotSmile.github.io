<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Smile Task Manager</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#000; --fg:#fff; --muted:rgba(255,255,255,0.75);
    --accent:#00d1ff; --high:#ff6b6b; --med:#ffd166; --low:#7bed9f;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:'Press Start 2P',monospace}
  header{border-bottom:2px solid var(--fg);padding:14px 16px;position:relative}
  h1{margin:0;font-size:18px}
  #timerContainer{display:inline-block;margin-top:10px;padding:8px 14px;border:2px solid var(--fg);background:var(--bg);box-shadow:0 0 8px var(--fg);font-size:12px}
  #notifyBtn{position:absolute;right:16px;top:12px;background:var(--bg);border:2px solid var(--fg);color:var(--fg);padding:6px 10px;cursor:pointer}
  #notifyBtn:hover{background:var(--fg);color:#000}
  main{max-width:1100px;margin:18px auto;padding:12px;box-sizing:border-box}
  .layout{display:flex;gap:20px;align-items:flex-start;justify-content:center}
  @media(max-width:980px){ .layout{flex-direction:column;align-items:center} #statusBox,#tasksBox{width:90%}}
  #statusBox,#tasksBox{border:2px solid var(--fg);background:var(--bg);padding:20px;width:42%;min-height:420px;box-sizing:border-box}
  #statusBox{display:flex;flex-direction:column;align-items:center;justify-content:center}
  #statusBox img{width:110px;height:110px;image-rendering:pixelated;border:2px solid var(--fg);padding:4px;background:var(--bg)}
  .task-form input,.task-form select{width:100%;box-sizing:border-box;padding:8px;margin-bottom:8px;background:var(--bg);color:var(--fg);border:2px solid var(--fg);font-family:inherit}
  .task-row{display:flex;gap:8px}
  .task-row .small{flex:0 0 160px}
  .btn{background:transparent;border:2px solid var(--fg);color:var(--fg);padding:8px 10px;cursor:pointer;font-family:inherit}
  .btn:hover{background:var(--fg);color:#000}
  .tasks-list{margin-top:12px;list-style:none;padding:0}
  .task{display:flex;justify-content:space-between;align-items:center;padding:10px;border-bottom:1px dashed var(--muted);gap:8px}
  .task .meta{font-size:11px;color:var(--muted)}
  .task-actions button{margin-left:6px;padding:6px 8px;font-size:10px}
  .progress-wrap{margin-top:12px}
  progress{width:100%;height:14px}
  .no-tasks{color:var(--muted);font-size:12px;text-align:center;padding:12px}
  /* Video overlay */
  #videoOverlay{display:none;position:fixed;inset:0;background:#000;z-index:9999;align-items:center;justify-content:center}
  #videoOverlay video{width:80%;border:3px solid var(--fg);background:#000}
  /* Payment modal */
  #paymentModal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:10000;align-items:center;justify-content:center}
  .pay-box{width:92%;max-width:520px;border:3px solid var(--fg);padding:18px;background:var(--bg);box-sizing:border-box;text-align:left}
  .pay-box h2{margin:0 0 8px 0;font-size:14px}
  .price{font-size:20px;margin:8px 0}
  .pay-methods{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  .pay-method{flex:1;border:2px solid var(--fg);padding:10px;text-align:center;cursor:pointer}
  .pay-method:hover{background:var(--fg);color:#000}
  .small{font-size:11px;color:var(--muted)}
  .center{text-align:center}
  /* spinner */
  .spinner{width:28px;height:28px;border:4px solid rgba(255,255,255,0.08);border-top-color:var(--fg);border-radius:50%;animation:spin 1s linear infinite;display:inline-block;vertical-align:middle}
  @keyframes spin{to{transform:rotate(360deg)}}
  /* notice */
  .notice{margin-top:12px;padding:8px;border:2px dashed var(--muted);color:var(--muted);font-size:12px}
</style>
</head>
<body>
  <!-- üîê PIN ACCESS SYSTEM (Undertale style) -->
<div id="pinScreen" style="
  position: fixed; inset: 0;
  background: black;
  color: white;
  font-family: 'Press Start 2P', monospace;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  text-align: center;
">
  <h2 style="font-size: 14px;">ACCESS REQUIRED</h2>
  <p style="font-size: 10px;">Enter your 6-digit PIN</p>
  <input id="pinInput" type="password" maxlength="6"
    style="background:black;border:2px solid white;color:white;
    padding:6px;text-align:center;font-family:'Press Start 2P',monospace;">
  <button id="verifyPin" style="
    margin-top:10px;background:black;color:white;
    border:2px solid white;padding:6px 14px;
    font-family:'Press Start 2P',monospace;cursor:pointer;">OK</button>
  <p id="pinMsg" style="font-size:10px;color:#ccc;margin-top:10px;"></p>
</div>

<script>
// --- PIN ACCESS CONTROL ---
const AUTH_KEY = "smile_pin_ok";
const USED_PINS_KEY = "used_pins_list";
const STORED_HASHES = [
  "6221454d3ae9dc0218ee729f486c23ff4a3e174f2abd47360766dddfeaca1682",
  "c0f53cb9c082c687da233dc62da43be32801dd3d9cf2d18335834b54b0cd3f89",
  "1e13e07b8484e730997fbe516f1e0adf94729dbb30c2e92dfbdb9839c6e4e434",
  "be11e4041db29c41f1ef4b2a83747a9876e7d4f9b62e5235696385e43f647c2f",
  "3a0612426eb65e00bedc3a710151c53024b0d5077823a4f2a684a2723dd14174",
  "29ce52a7665088dce617f603c37414ced582639b935e0c283662a07c45ebb733",
  "8a407c914628a873a1c6fbf03830e9a0b5337972885be90899cf41458de192f8",
  "14b7b7e3baec54ee94dc85af8da927f0d7a2177bb683e752ebc106a56b5d6de4",
  "c06970b069987b0424d5c61476a566aa52f19077fa1bb133ca5572b0e086f38e",
  "4b7478a8ecf570ec213c9f2ba7248671025ca4cf507a025ce40e046a21b38c4d",
  "3d0eb4d649154304dbf910a477076085edeb6a42b49dc535e20abe583ee4701e",
  "f783f5739e82fc3febc430175d842a6bedded4446a271081ee28ba96ef1778bd",
  "9c652ad75b4e3a2c1f1619fdbf084709223bb0c24bb6eb642518a63d54939035",
  "62ca4a15c50638e44b48b630a31dc0ca0d25b12fe15871b6507b938a9ce5e56d",
  "3b8a2bc00b1d1cbdf8decdf1400913affe91e56a48bb091705ce04c295ff5ebc",
  "eed8d091319a1c7cfbb4195a07f59e87771a20fd2ae371087c762dc00455742e",
  "c2501731caa33b92f24106eaa37de28edc7d4e1548e9fab463cd8e0e4c8c0771",
  "46760ee4030b8663a5c92604711bba26afa00136aa11b07d97617d91ecd58081",
  "3d5e554a8268b0baf4ff9d81eb9b77d81e3c3834350caca50c3833da49c6134e",
  "f34534b36ae4cb11cd7b8befae3a1acf6e766a78295f2a1c9eef7b3256ea5e8c",
  "583941e9ea1fd6d103b91587413c872daa05a2a0d5312f15a6a607a0b68847a7",
  "2ad562e66423f2618eb02316d328342f87f6bf4f26b10d59c6b854c49ddc305c",
  "f9c8f624b542e7f324c95dc080f90b6f572eb72d6667b85113f43cf51ec044a4",
  "0431bacf9fc018a05ff568972caab847af3326a54e572c8ae14dc5d17214c1ed",
  "138e00a0a1b0846a2aa337e0fad042d2b168176184d8cfbfafa0849bdd95c068",
  "ce0b5e444993bce62439a78fe31202c5b7b93f38dde2786b8ee2366a9e1726ac",
  "6c1c9509c6c1849d835aece75a3836a99f5795e3392f45232421e0f1ad36235d",
  "8cb96cb14f8abe90d9d73e6d01418337434afb7935b9acac09ea2ded38ca3714",
  "db2042979f4883085f86d94db833965ef8ca303d139d8eaeb485590c976440d6",
  "05853cc8379476d8bb3d350625a3bc08b91214049be1847d4e5403cc44715e31"
];


// Si ya est√° autenticado, omitir pantalla
if (localStorage.getItem(AUTH_KEY)) {
  document.getElementById("pinScreen").style.display = "none";
} else {
  document.body.style.overflow = "hidden"; // bloquear scroll
}

const usedPins = JSON.parse(localStorage.getItem(USED_PINS_KEY) || "[]");

document.getElementById("verifyPin").onclick = async () => {
  const input = document.getElementById("pinInput").value.trim();
  const msg = document.getElementById("pinMsg");
  if (!input) return (msg.textContent = "Enter PIN");

  const hash = await sha256Hex(input);

  if (usedPins.includes(hash)) {
    msg.textContent = "‚ùå PIN already used";
    return;
  }

  if (STORED_HASHES.includes(hash)) {
    msg.textContent = "‚úÖ Access granted";
    usedPins.push(hash);
    localStorage.setItem(USED_PINS_KEY, JSON.stringify(usedPins));
    localStorage.setItem(AUTH_KEY, "1");
    setTimeout(() => {
      document.getElementById("pinScreen").style.display = "none";
      document.body.style.overflow = "auto";
    }, 800);
  } else {
    msg.textContent = "‚ùå Invalid PIN";
  }
};

// --- SHA-256 hash function ---
async function sha256Hex(str) {
  const buf = new TextEncoder().encode(str);
  const hashBuf = await crypto.subtle.digest("SHA-256", buf);
  const hashArray = Array.from(new Uint8Array(hashBuf));
  return hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
}
</script>


  <header>
    <h1>Smile Task Manager</h1>
    <div id="timerContainer">‚è± <span id="timerDisplay">06:07</span></div>
    <button id="notifyBtn" class="btn" onclick="enableNotifications()">üîî Enable Notifications</button>
  </header>

  <main class="main">
    <div class="layout">
      <!-- Smile box -->
      <div id="statusBox">
        <img src="logo.png" alt="Smile avatar">
        <div id="smileText" style="margin-top:12px;line-height:1.4;text-align:center">Keep it up!</div>
      </div>

      <!-- Tasks box -->
      <div id="tasksBox">
        <div class="task-form">
          <input id="titleInput" type="text" placeholder="Task title...">
          <div class="task-row" style="margin-bottom:8px">
            <input id="dateInput" type="date" class="small">
            <select id="priorityInput" class="small">
              <option value="High">High Priority</option>
              <option value="Medium">Medium Priority</option>
              <option value="Low">Low Priority</option>
            </select>
            <button id="addBtn" class="btn">Add Task</button>
          </div>
        </div>

        <div style="margin-top:10px">
          <div class="progress-wrap">
            <div id="progressText" style="font-size:11px;margin-bottom:6px">Progress: 0%</div>
            <progress id="progressFill" value="0" max="100"></progress>
          </div>
          <ul id="taskList" class="tasks-list"></ul>
          <div id="noTasks" class="no-tasks">No tasks yet. Add one to get started!</div>
        </div>
      </div>
    </div>
  </main>

  <!-- Video overlay -->
  <div id="videoOverlay">
    <video id="memeVideo" controls preload="auto">
      <source src="67.mp4" type="video/mp4">
    </video>
  </div>

<script>

/* ---------------------------
   Timer & video
   --------------------------- */
let countdown = 367;
const timerDisplay = document.getElementById('timerDisplay');
const overlay = document.getElementById('videoOverlay');
const memeVideo = document.getElementById('memeVideo');
let timerInterval = null;

function formatTime(sec){
  const m = String(Math.floor(sec/60)).padStart(2,'0');
  const s = String(sec%60).padStart(2,'0');
  return `${m}:${s}`;
}

function updateTimer(){
  timerDisplay.textContent = formatTime(countdown);
  countdown--;
  if (countdown < 0){
    clearInterval(timerInterval);
    
    }
  }

function restartTimer(){
  countdown = 367;
  timerDisplay.textContent = formatTime(countdown);
  timerInterval = setInterval(updateTimer,1000);
}

function showVideo(){
  overlay.style.display = 'flex';
  try{ memeVideo.currentTime = 0; memeVideo.play(); }catch(e){}
  memeVideo.onended = ()=> {
    overlay.style.display = 'none';
    restartTimer();
  };
}

timerInterval = setInterval(updateTimer,1000);

/* ---------------------------
   Task manager (local only)
   --------------------------- */
const titleInput = document.getElementById('titleInput');
const dateInput = document.getElementById('dateInput');
const priorityInput = document.getElementById('priorityInput');
const addBtn = document.getElementById('addBtn');
const taskList = document.getElementById('taskList');
const noTasks = document.getElementById('noTasks');
const progressFill = document.getElementById('progressFill');
const progressText = document.getElementById('progressText');
const smileText = document.getElementById('smileText');

let tasks = JSON.parse(localStorage.getItem('smile_tasks_v2') || '[]');

function saveTasks(){ localStorage.setItem('smile_tasks_v2', JSON.stringify(tasks)); }

function renderTasks(){
  taskList.innerHTML = '';
  if (tasks.length === 0) noTasks.style.display = 'block'; else noTasks.style.display = 'none';

  let done = 0;
  tasks.forEach((t, idx) => {
    const li = document.createElement('li');
    li.className = 'task';
    const left = document.createElement('div');
    left.style.flex='1';
    left.innerHTML = `<strong style="font-size:12px">${escapeHtml(t.title)}</strong><div class="meta">${t.date || 'No date'} ‚Ä¢ ${t.priority}</div>`;
    const actions = document.createElement('div');
    actions.className = 'task-actions';
    const completeBtn = document.createElement('button');
    completeBtn.className='btn';
    completeBtn.textContent = t.done ? 'Undo' : 'Complete';
    completeBtn.onclick = ()=> { t.done = !t.done; saveTasks(); renderTasks(); typeSmile(pick(smilePhrases)); };
    const delBtn = document.createElement('button');
    delBtn.className='btn';
    delBtn.textContent = 'Delete';
    delBtn.onclick = ()=> { tasks.splice(idx,1); saveTasks(); renderTasks(); typeSmile('Task removed.'); };
    actions.appendChild(completeBtn); actions.appendChild(delBtn);

    if (t.done) done++;
    if (t.done) left.querySelector('strong').style.textDecoration = 'line-through';

    li.appendChild(left); li.appendChild(actions);
    taskList.appendChild(li);
  });

  const pct = tasks.length ? Math.round(done/tasks.length*100) : 0;
  progressFill.value = pct;
  progressText.textContent = `Progress: ${pct}% (${done}/${tasks.length})`;
}

addBtn.addEventListener('click', ()=>{
  const title = titleInput.value.trim();
  if (!title){ typeSmile('Please enter a task title.'); return; }
  const date = dateInput.value || '';
  const priority = priorityInput.value;
  tasks.push({title,date,priority,done:false});
  saveTasks(); renderTasks();
  titleInput.value=''; dateInput.value=''; priorityInput.selectedIndex=1;
  typeSmile(pick(smilePhrases));
});

/* ---------------------------
   Smile typing + phrases
   --------------------------- */
const smilePhrases = [
  "Good job!",
  "You're doing great!",
  "I'm proud of you!",
  "Keep it up!",
  "you're my good little boy!",
  "Good boy"
];

function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

const blipAudio = new Audio('https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg');
function typeSmile(text){
  const el = document.getElementById('smileText');
  el.textContent = '';
  let i = 0;
  function step(){
    if (i < text.length){
      const ch = text.charAt(i);
      el.textContent += ch;
      if (ch.trim() !== '') { try{ blipAudio.currentTime = 0; blipAudio.play(); }catch(e){} }
      i++; setTimeout(step,36);
    }
  }
  step();
}

const notifPhrases = [
  "Smile says: Don't forget to check your tasks!",
  "Time to get things done!",
  "Remember to stay focused!",
  "Take a moment to review your upcoming deadlines."
];

function enableNotifications(){
  if (!('Notification' in window)){ alert('Notifications not supported'); return; }
  Notification.requestPermission().then(perm=>{
    if (perm === 'granted'){
      typeSmile('Notifications enabled. I will remind you every 12 hours.');
      // send one immediately and schedule
      sendNotification();
      // store interval id in window to allow clearing later if needed
      if (!window.smileNotifInterval){ window.smileNotifInterval = setInterval(sendNotification, 43200000); } // 12h
    } else {
      typeSmile('Notifications blocked.');
    }
  });
}

function sendNotification(){
  if (Notification.permission !== 'granted') return;
  const body = pick(notifPhrases);
  try{ new Notification('Smile Reminder', { body, icon: 'logo.png' }); }catch(e){}
}

/* ---------------------------
   Init
   --------------------------- */
(function init(){
  // If not paid, we already show modal on load (above)
  renderTasks();
  renderAchievementsIfAny(); // placeholder - keep compatibility
  // greet
  setTimeout(()=> typeSmile("Hello! I'm Smile, your helper."), 400);
})();

function renderAchievementsIfAny(){ /* no achievements UI in this layout; kept for safety */ }

/* ---------------------------
   Utilities
   --------------------------- */
function escapeHtml(str){ return String(str).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[m]); }
  /* üîî NOTIFICACIONES CADA 12 HORAS */
async function requestNotificationPermission() {
  if (!("Notification" in window)) {
    console.log("Tu navegador no soporta notificaciones.");
    return;
  }
  const permission = await Notification.requestPermission();
  if (permission === "granted") {
    console.log("Notificaciones activadas.");
  } else {
    console.log("Permiso de notificaciones denegado.");
  }
}

function showNotification() {
  const options = {
    body: "Remember to check your tasks, you‚Äôre doing great! üíô",
    icon: "logo.png", // o cualquier otra imagen que tengas
    badge: "logo.png",
  };
  new Notification("Smile Task Manager", options);
}

// Pide permiso al cargar
requestNotificationPermission();

// Programa notificaci√≥n cada 12 horas
const TWELVE_HOURS = 12 * 60 * 60 * 1000;
setInterval(() => {
  if (Notification.permission === "granted") {
    showNotification();
  }
}, TWELVE_HOURS);

// Tambi√©n una de prueba a los 5 segundos (puedes quitarla)
setTimeout(() => {
  if (Notification.permission === "granted") {
    showNotification();
  }
}, 5000);

</script>
 <a href="index.html" id="fixed-btn">volver</a>

<style>
  #fixed-btn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: black;
    color: white;
    border: 3px solid white;
    padding: 10px 20px;
    font-family: "Press Start 2P", monospace;
    font-size: 12px;
    text-decoration: none;
    cursor: pointer;
    z-index: 1000;
    transition: all 0.2s ease-in-out;
  }

  #fixed-btn:hover {
    background: white;
    color: black;
  }

  /* En pantallas peque√±as (celulares) */
  @media (max-width: 600px) {
    #fixed-btn {
      font-size: 10px;
      padding: 8px 14px;
      bottom: 10px;
      right: 10px;
    }
  }
</style>
</body>
</html>








